<!DOCTYPE html>
<html dir="ltr">
  <head>
    <meta charset="UTF-8"/>
    <title>7.2.1.7 TCP Session Termination Analysis</title>
    <!-- Content -->
    <link type="text/css" rel="stylesheet" href="../../common/styles/course.css"/>
	<script type="text/javascript" src="../../common/scripts/jquery_bundle.min.js"></script>
    <script>
      var myLayout; 
      $(document).ready(function () {
    	myLayout = $('body').layout({
          west__size:300,
          stateManagement__enabled: true,
          maskContents: true,
          livePaneResizing: true,
          onresize_end: resizeTextDiv,
          stateManagement__cookie__name: "ui_pane",
          stateManagement__cookie__expires: 1,
          stateManagement__cookie__path: "/"
        });
      });
      function resizeTextDiv() {
        var DivHeight = document.getElementById("header").offsetHeight;
        document.getElementById("content").style.top = String(DivHeight) + 'px';
      }
    </script>
  </head>
  <body class="onecolumn" onLoad="resizeTextDiv()">
    <div class="ui-layout-west">
      <div id="header">
        <h1>TCP and UDP</h1>
        <h2>TCP Communication</h2>
      </div>
      <div id="content">
          <p>To close a connection, the Finish (FIN) control flag must be set in the segment header. To end each one-way TCP session, a two-way handshake is used, consisting of a FIN segment and an ACK segment. Therefore, to terminate a single conversation supported by TCP, four exchanges are needed to end both sessions, as shown in Figure 1.</p>
          <p></p>
          <p>
            <b>Note</b>: In this explanation, the terms client and server are used as a reference for simplicity, but the termination process can be initiated by any two hosts that have an open session:</p>
          <p></p>
          <p>
            <b>Step 1:</b> When the client has no more data to send in the stream, it sends a segment with the FIN flag set.</p>
          <p></p>
          <p>
            <b>Step 2:</b> The server sends an ACK to acknowledge the receipt of the FIN to terminate the session from client to server.</p>
          <p></p>
          <p>
            <b>Step 3:</b> The server sends a FIN to the client, to terminate the server to client session.</p>
          <p></p>
          <p>
            <b>Step 4:</b> The client responds with an ACK to acknowledge the FIN from the server.</p>
          <p></p>
          <p>When the client has no more data to transfer, it sets the FIN flag in the header of a segment. Next, the server end of the connection sends a normal segment containing data with the ACK flag set using the acknowledgment number, confirming that all the bytes of data have been received. When all segments have been acknowledged, the session is closed.</p>
          <p></p>
          <p>The session in the other direction is closed using the same process. The receiver indicates that there is no more data to send by setting the FIN flag in the header of a segment sent to the source. A return acknowledgement confirms that all bytes of data have been received and that session is, in turn, closed.</p>
          <p></p>
          <p>Refer to Figures 2 and 3 to see the FIN and ACK control flags set in the segment header, thereby closing a HTTP session.</p>
          <p></p>
          <p>It is also possible to terminate the connection by a three-way handshake. When the client has no more data to send, it sends a FIN to the server. If the server also has no more data to send, it can reply with both the FIN and ACK flags set, combining two steps into one. The client then replies with an ACK.</p>
        </div>
    </div>
    <iframe id="mainFrame" name="mainFrame" src="media/index.html" frameborder="0" class="ui-layout-center" alt="interactive graphic" longdesc="media_7.2.1.7_longdesc.txt"></iframe>
  </body>
</html>
